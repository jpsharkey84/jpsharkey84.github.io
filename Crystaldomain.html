<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Living Menu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg: #0b0e14;
  --panel: #141926;
  --text: #e6e6eb;
  --muted: #9aa0b5;
  --accent: #4fd1c5;
  --cursor: #ffffff;
}

* {
  box-sizing: border-box;
  font-family: "Segoe UI", system-ui, sans-serif;
}

body {
  margin: 0;
  height: 100vh;
  background: radial-gradient(circle at top, #151a2e, var(--bg));
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text);
}

.menu-container {
  background: var(--panel);
  width: 320px;
  padding: 20px 24px;
  border-radius: 14px;
  box-shadow: 0 30px 80px rgba(0,0,0,.6);
}

.menu-title {
  font-size: 18px;
  margin-bottom: 14px;
  color: var(--accent);
  letter-spacing: 1px;
}

.menu {
  list-style: none;
  padding: 0;
  margin: 0;
}

.menu li {
  display: flex;
  align-items: center;
  padding: 8px 6px;
  margin: 4px 0;
  border-radius: 6px;
  transition: background .15s ease;
}

.menu li.active {
  background: rgba(79,209,197,.12);
}

.cursor {
  width: 12px;
  margin-right: 10px;
  color: var(--cursor);
  opacity: 0;
  transition: opacity .15s ease;
}

.menu li.active .cursor {
  opacity: 1;
}

.menu span {
  font-size: 15px;
}

.footer {
  margin-top: 16px;
  font-size: 11px;
  color: var(--muted);
  text-align: right;
}
</style>
</head>

<body>

<div class="menu-container">
  <div class="menu-title">MAIN MENU</div>

  <ul class="menu" id="menu">
    <li><div class="cursor">▶</div><span>Records</span></li>
    <li><div class="cursor">▶</div><span>Journal</span></li>
    <li><div class="cursor">▶</div><span>Inventory</span></li>
    <li><div class="cursor">▶</div><span>Settings</span></li>
    <li><div class="cursor">▶</div><span>Save</span></li>
    <!-- ADD MENU ITEM HERE -->
  </ul>

  <div class="footer">↑ ↓ select · enter confirm</div>
</div>

<script>
const menu = document.getElementById("menu");
const items = [...menu.children];

let index = Number(localStorage.getItem("menuIndex")) || 0;

function render() {
  items.forEach((item, i) => {
    item.classList.toggle("active", i === index);
  });
  localStorage.setItem("menuIndex", index);
}

function move(dir) {
  index += dir;
  if (index < 0) index = items.length - 1;
  if (index >= items.length) index = 0;
  render();
}

function select() {
  const choice = items[index].innerText.trim();
  alert("Selected: " + choice);
  // ADD LOGIC HERE
}

document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp") move(-1);
  if (e.key === "ArrowDown") move(1);
  if (e.key === "Enter") select();
});

// Touch support
items.forEach((item, i) => {
  item.addEventListener("click", () => {
    index = i;
    render();
    select();
  });
});

render();
</script>
<script>
/* ===========================
   ADDITIVE SYSTEM LAYER
   =========================== */

// Panel container (created dynamically)
const panel = document.createElement("div");
panel.style.position = "fixed";
panel.style.inset = "0";
panel.style.background = "rgba(11,14,20,.95)";
panel.style.display = "none";
panel.style.alignItems = "center";
panel.style.justifyContent = "center";
panel.style.zIndex = "10";
document.body.appendChild(panel);

// Panel content
const panelBox = document.createElement("div");
panelBox.style.background = "var(--panel)";
panelBox.style.width = "340px";
panelBox.style.minHeight = "200px";
panelBox.style.borderRadius = "14px";
panelBox.style.padding = "20px";
panelBox.style.color = "var(--text)";
panel.appendChild(panelBox);

// Save system
const saveKey = "livingMenuSaves";
const saves = JSON.parse(localStorage.getItem(saveKey) || "{}");

function openPanel(title, content) {
  panelBox.innerHTML = `
    <h3 style="margin-top:0;color:var(--accent)">${title}</h3>
    <div>${content}</div>
    <div style="margin-top:20px;font-size:12px;opacity:.7">ESC to return</div>
  `;
  panel.style.display = "flex";
}

function closePanel() {
  panel.style.display = "none";
}

// Extend select() WITHOUT replacing it
const originalSelect = select;
select = function () {
  const choice = items[index].innerText.trim();

  if (choice === "Records") {
    openPanel("Records", "<p>No records yet.</p>");
  }
  else if (choice === "Journal") {
    openPanel(
      "Journal",
      `<textarea id="journal" style="width:100%;height:120px;background:#0b0e14;color:white;border:0;padding:8px"></textarea>
       <button onclick="saveJournal()">Save</button>`
    );
    document.getElementById("journal").value = saves.journal || "";
  }
  else if (choice === "Settings") {
    openPanel(
      "Settings",
      `<button onclick="setTheme('dark')">Dark</button>
       <button onclick="setTheme('teal')">Teal</button>`
    );
  }
  else {
    originalSelect(); // fallback
  }
};

// Journal save
function saveJournal() {
  saves.journal = document.getElementById("journal").value;
  localStorage.setItem(saveKey, JSON.stringify(saves));
}

// Theme system (CSS variable swap)
function setTheme(mode) {
  if (mode === "teal") {
    document.documentElement.style.setProperty("--accent", "#4fd1c5");
  }
  if (mode === "dark") {
    document.documentElement.style.setProperty("--accent", "#ffffff");
  }
}

// Back navigation
document.addEventListener("keydown", e => {
  if (e.key === "Escape" && panel.style.display === "flex") {
    closePanel();
  }
});
</script>
</body>
</html>
